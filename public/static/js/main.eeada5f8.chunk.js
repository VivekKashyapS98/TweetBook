(this["webpackJsonptweetbook-client"]=this["webpackJsonptweetbook-client"]||[]).push([[0],{116:function(e,t,a){e.exports=a(145)},121:function(e,t,a){},145:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),o=a.n(l),c=(a(121),a(37)),i=a(28),s={isAuthenticated:!1,user:{}},u=Object(c.c)({currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(i.a)(Object(i.a)({},e),{},{isAuthenticated:!!Object.keys(t.payload.user).length,user:t.payload.user});default:return e}}}),m=a(89);var d=a(14),h=a(19),f=a(12),p=(a(30),a(178)),E=Object(d.b)((function(e){return{auth:e.currentUser.isAuthenticated}}),null)((function(e){var t=Object(f.e)();return e.auth?(t.push("/home"),r.a.createElement("p",null,"loading...")):r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"header"},r.a.createElement("h2",{className:"logo"},"TweetBook"),r.a.createElement("div",{className:"nav"},r.a.createElement(p.a,{component:"div",color:"inherit",className:"nav-button",onClick:function(){return t.push("/signup")}},"Signup"),r.a.createElement(p.a,{component:"div",color:"inherit",className:"nav-button",onClick:function(){return t.push("/login")}},"Login"))),r.a.createElement("div",{className:"background-img"},r.a.createElement("div",{className:"welcome"},r.a.createElement("h1",{className:"welcome-text"},"Welcome to TweetBook!"),r.a.createElement("p",{className:"welcome-desc"},r.a.createElement("b",null,"Login/Signup")," to explore more..."))))})),g=a(23),b=a(24),v=a(27),w=a(26),y=a(182),j=a(183),O=a(95),k=a.n(O),C=a(94),S=a.n(C),N=a(93),U=a.n(N),x=a(96),_=a.n(x),T=a(184);var P=Object(d.b)((function(e){return{user:e.currentUser.user.id}}),null)((function(e){var t=Object(f.e)();return r.a.createElement("div",{className:"navbar"},r.a.createElement(y.a,{value:e.value,className:"bottom-nav"},r.a.createElement(j.a,{component:h.b,to:"/home",label:"Home",value:"Home",icon:r.a.createElement(U.a,null),default:!0}),r.a.createElement(j.a,{component:h.b,to:"/notifications",label:"Notifications",value:"Notifications",icon:r.a.createElement(S.a,null)}),r.a.createElement(j.a,{component:h.b,to:"/user/".concat(e.user),label:"User",value:"User",icon:r.a.createElement(k.a,null)})),r.a.createElement(T.a,{component:"button",className:"add-icon",color:"primary",onClick:function(){return t.push("/newTweet")}},r.a.createElement(_.a,null)))})),D=a(22),R=a(198),W=a(185),I=a(199),F=a(63),A=a.n(F);function B(e,t,a){return new Promise((function(n,r){A.a[e](t,a).then((function(e){return n(e.data)})).catch((function(e){return r(e.response.data.error)}))}))}var L=a(97),M=a.n(L),z=function(e){var t=e.post,a=Object(f.e)(),l=Object(i.a)({},t.user),o=Object(n.useState)(t.likes.some((function(e){return e===t.user._id}))?"secondary":"action"),c=Object(D.a)(o,2),s=c[0],u=c[1],m=Object(n.useState)(t.likes.length),d=Object(D.a)(m,2),h=d[0],p=d[1];return r.a.createElement("div",{className:"message-card"},r.a.createElement("p",{className:"post-text"},t.text),r.a.createElement(W.a,{component:"div",className:"msgcard-info"},r.a.createElement("div",{className:"msgcard-like"},r.a.createElement(M.a,{onClick:function(){"secondary"===s?B("delete","/api/users/".concat(t.user._id,"/message/").concat(t._id,"/like")).then((function(e){u("action"),p(h-1),console.log(e)})).catch((function(e){return console.log(e)})):B("post","/api/users/".concat(t.user._id,"/message/").concat(t._id,"/like")).then((function(e){u("secondary"),p(h+1),console.log(e)})).catch((function(e){return console.log(e)}))},fontSize:"small",color:s}),r.a.createElement("p",{style:{margin:"0 10px 0 0"}},h),r.a.createElement(R.a,{label:new Date(t.updatedAt).toDateString()})),r.a.createElement(R.a,{avatar:r.a.createElement(I.a,{alt:l.username,src:l.profileImgUrl}),onClick:function(){return a.push("/user/".concat(l._id))},label:l.username})))},q=a(186),X=a(62),H=function(e){!function(e){e?A.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete A.a.defaults.headers.common.Authorization}(e)},J=function(e,t){return function(a){return new Promise((function(n,r){B("post","/api/auth/".concat(e),t).then((function(e){var t=e.token,r=Object(X.a)(e,["token"]);localStorage.setItem("jwtToken",t),H(localStorage.jwtToken),a({type:"SET_CURRENT_USER",payload:{user:r}}),n(r)})).catch((function(e){return r(e)}))}))}},G=function(e){Object(v.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).state={feed:null,load:!1},n}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.loadMessages().then((function(t){e.setState({feed:t,load:!0})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=r.a.createElement("div",{className:"loading"},r.a.createElement(q.a,null));return!0===this.state.load&&(t=this.state.feed.map((function(t,a){return r.a.createElement(z,{key:a,reload:function(){return e.reloadConmponent()},post:t})}))),console.log(this.state.feed),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-page"},r.a.createElement("div",null,t)),r.a.createElement(P,{value:"Home"}))}}]),a}(n.Component),V=Object(d.b)((function(e){return{user:e.currentUser.user,messages:e.messages}}),{loadMessages:function(){return function(e){return new Promise((function(t,a){B("get","/api/messages").then((function(a){e({type:"GET_MESSAGES",payload:{messages:a}}),t(a)})).catch((function(e){return a(e.message)}))}))}}})(G),Y=a(4),$=a(197),K=a(187),Q=a(189),Z=a(188),ee=a(98),te=a.n(ee),ae=a(102),ne=Object(Y.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose,l=Object(X.a)(e,["children","classes","onClose"]);return r.a.createElement(K.a,Object.assign({disableTypography:!0,className:a.root},l),r.a.createElement(ae.a,{variant:"h6"},t),n?r.a.createElement(Z.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(te.a,null)):null)})),re=Object(Y.a)((function(e){return{root:{padding:e.spacing(2)}}}))(Q.a),le={display:"flex",flexDirection:"row",borderRadius:"20px",margin:"5px",padding:"5px",minWidth:"80px"};function oe(e){var t=e.user,a=Object(n.useState)(!1),l=Object(D.a)(a,2),o=l[0],c=l[1],i=Object(n.useState)(null),s=Object(D.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(null),h=Object(D.a)(d,2),f=h[0],p=h[1],E=function(e,t){c(!0),m(e),p(t)},g=function(){p(""),m(null),c(!1)},b=r.a.createElement(q.a,null);return null!==u&&(b=u.map((function(e,t){return r.a.createElement("div",{key:t,style:le},r.a.createElement(I.a,{alt:"Remy Sharp",src:e.profileImgUrl}),r.a.createElement("h4",{style:{margin:"5px"}},e.username))}))),r.a.createElement("div",null,r.a.createElement("div",{className:"profile-row"},r.a.createElement(R.a,{component:"div",style:{padding:"10px",margin:"10px"},label:"followers ".concat(t.followers.length),onClick:function(){return E(t.followers,"followers")}}),r.a.createElement(R.a,{componenet:"div",style:{padding:"10px",margin:"10px"},label:"following ".concat(t.following.length),onClick:function(){return E(t.following,"Following")}})),r.a.createElement($.a,{onClose:g,"aria-labelledby":"customized-dialog-title",open:o},r.a.createElement(ne,{id:"customized-dialog-title",onClose:g},f),r.a.createElement(re,null,b)))}var ce=a(194),ie=a(193),se=a(190),ue=a(99),me=a.n(ue);function de(e){var t=e.editProfile,a=Object(n.useState)(!1),l=Object(D.a)(a,2),o=l[0],c=l[1],i=Object(n.useState)(null),s=Object(D.a)(i,2),u=s[0],m=s[1],d=Object(n.useState)(null),h=Object(D.a)(d,2),f=h[0],E=h[1],g=function(){c(!1)};return r.a.createElement("div",null,r.a.createElement(p.a,{component:"button",onClick:function(){c(!0)},style:{padding:"15px",margin:"auto 0",borderRadius:"50%"},variant:"contained"},r.a.createElement(me.a,null)),r.a.createElement($.a,{open:o,onClose:g,"aria-labelledby":"form-dialog-title"},r.a.createElement(K.a,{id:"form-dialog-title"},"Edit Profile:"),r.a.createElement(Q.a,null,r.a.createElement(se.a,null,"Edit the Bio:"),r.a.createElement(ce.a,{autoFocus:!0,margin:"dense",id:"name",label:"Describe yourself",type:"text",onChange:function(e){return m(e.target.value)},fullWidth:!0}),r.a.createElement(se.a,null,"Profile Picture:"),r.a.createElement(ce.a,{autoFocus:!0,margin:"dense",id:"name",label:"Paste a link of nice picture",type:"text",onChange:function(e){return E(e.target.value)},fullWidth:!0})),r.a.createElement(ie.a,null,r.a.createElement(p.a,{onClick:g,color:"primary"},"Cancel"),r.a.createElement(p.a,{onClick:function(){t({bio:u,profilePic:f}),c(!1)},color:"primary"},"Update"))))}var he=function(e){Object(v.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).state={user:null,load:!1,navbar:null,follow:null},n}return Object(b.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id,a=this.props.user;B("get","/api/users/".concat(t)).then((function(n){console.log(n),t===a.id?e.setState({user:n,load:!0,navbar:"User"}):n.followers.some((function(e){return e._id===a.id}))?e.setState({user:n,load:!0,follow:"following"}):e.setState({user:n,load:!0,follow:"follow"})})).catch((function(e){return console.log(e)}))}},{key:"handleFollow",value:function(){var e=this,t=this.state,a=t.follow,n=t.user;B("follow"===a?"post":"delete","/api/users/".concat(this.props.user.id,"/follow/").concat(n._id)).then((function(t){"followed"===t.tweet?e.setState({follow:"following"}):e.setState({follow:"follow"}),console.log(t.tweet)})).catch((function(e){return console.log(e)}))}},{key:"editProfile",value:function(e){var t=e.bio,a=e.profilePic,n={};null!==a&&(n=Object(i.a)(Object(i.a)({},n),{},{profileImgUrl:a})),null!==t&&(n=Object(i.a)(Object(i.a)({},n),{},{bio:t})),B("put","/api/users/".concat(this.props.user.id),n).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this,t=r.a.createElement(q.a,null);if(!0===this.state.load){var a=this.state.user,n=a.username,l=a.profileImgUrl,o=a.bio,c=a.followers,i=a.following,s=a.messages.map((function(e,t){return r.a.createElement(z,{key:t,post:e})}));t=r.a.createElement("div",null,r.a.createElement("div",{className:"profile-row"},r.a.createElement("img",{className:"profile-img",src:l||"https://www.knack.com/images/about/default-profile.png",alt:"profile-img"}),r.a.createElement("div",{className:"profile-info"},r.a.createElement("h1",{className:"username"},n),r.a.createElement("p",{style:{color:"white"}},o),r.a.createElement(oe,{user:{followers:c,following:i}})),this.state.navbar?r.a.createElement(de,{editProfile:function(t){return e.editProfile(t)}}):r.a.createElement(p.a,{component:"button",style:{margin:"auto 0"},variant:"contained",onClick:function(){return e.handleFollow()}},this.state.follow)),s)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-page"},t),r.a.createElement(P,{value:this.state.navbar}))}}]),a}(n.Component),fe=Object(f.f)(Object(d.b)((function(e){return{user:e.currentUser.user}}),null)(he)),pe=function(e){Object(v.a)(a,e);var t=Object(w.a)(a);function a(){return Object(g.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{value:"Notifications"}))}}]),a}(n.Component),Ee=a(50),ge=a(200),be=a(201),ve=a(191),we=a(192);function ye(e){var t=e.handleChange,a=e.input;return r.a.createElement(ge.a,{fullWidth:!0},r.a.createElement(be.a,{htmlFor:"my-input"},"User Name:"),r.a.createElement(ve.a,{required:!0,type:"text",id:"my-input","aria-describedby":"my-helper-text",name:"username",value:a,onChange:function(e){return t(e)}}),r.a.createElement(we.a,{id:"my-helper-text"},"Enter the user name."))}function je(e){var t=e.handleChange,a=e.input;return r.a.createElement(ge.a,{fullWidth:!0},r.a.createElement(be.a,{htmlFor:"my-input"},"Email address"),r.a.createElement(ve.a,{required:!0,type:"text",id:"my-input","aria-describedby":"my-helper-text",name:"email",value:a,onChange:function(e){return t(e)}}),r.a.createElement(we.a,{id:"my-helper-text"},"We'll never share your email."))}function Oe(e){var t=e.handleChange;return r.a.createElement(ge.a,{fullWidth:!0},r.a.createElement(be.a,{htmlFor:"my-input"},"Password"),r.a.createElement(ve.a,{required:!0,type:"password",id:"my-input","aria-describedby":"my-helper-text",name:"password",onChange:function(e){return t(e)}}),r.a.createElement(we.a,{id:"my-helper-text"},"Your passwords are always safe."))}function ke(e){var t=e.handleChange,a=e.input;return r.a.createElement(ge.a,{fullWidth:!0},r.a.createElement(be.a,{htmlFor:"my-input"},"Profile picture link:"),r.a.createElement(ve.a,{id:"my-input","aria-describedby":"my-helper-text",value:a,name:"profileImgUrl",onChange:function(e){return t(e)}}),r.a.createElement(we.a,{id:"my-helper-text"},"Enter the URL of the profile picture."))}var Ce=a(195),Se=function(e){Object(v.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).state={error:!1,errorDisc:"",auth:"",username:"",email:"",password:"",profileImgUrl:""},n}return Object(b.a)(a,[{key:"handleChange",value:function(e){var t;this.setState((t={},Object(Ee.a)(t,e.target.name,e.target.value),Object(Ee.a)(t,"auth",this.props.auth),t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.auth,r=a.username,l=a.email,o=a.password,c=a.profileImgUrl;"signup"===n?this.props.setCurrentUser(n,{username:r,email:l,password:o,profileImgUrl:c}).then((function(){t.props.history.push("/home")})).catch((function(e){return t.setState({error:!0,errorDisc:e.message})})):this.props.setCurrentUser(n,{email:l,password:o}).then((function(){t.props.history.push("/home")})).catch((function(e){return t.setState({error:!0,errorDisc:e.message})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.email,l=t.profileImgUrl,o="signup"===this.props.auth?r.a.createElement("div",{className:"form"},r.a.createElement("h2",{className:"auth-text"},"Join TweetBook today!"),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(ye,{input:a,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(je,{input:n,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(ke,{input:l,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(Oe,{handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Signup"),r.a.createElement("br",null),this.state.error?r.a.createElement(Ce.a,{severity:"error"},this.state.errorDisc):null)):r.a.createElement("div",{className:"form"},r.a.createElement("h2",{className:"auth-text"},"Login to TweetBook Now!"),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(je,{input:n,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(Oe,{handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Login"),r.a.createElement("br",null),this.state.error?r.a.createElement(Ce.a,{severity:"error"},this.state.errorDisc):null));return r.a.createElement(r.a.Fragment,null,o)}}]),a}(n.Component);var Ne=Object(f.f)(Object(d.b)((function(e){return{currentUser:e.currentUser}}),{setCurrentUser:J})(Se)),Ue=function(e){Object(v.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(g.a)(this,a),(n=t.call(this,e)).state={text:"",error:!1,errorDisc:""},n}return Object(b.a)(a,[{key:"handleChange",value:function(e){this.setState({text:e.target.value})}},{key:"handlePost",value:function(e){var t,a,n=this;e.preventDefault(),(t=this.props.currentUserId,a={text:this.state.text},new Promise((function(e,n){B("post","/api/users/".concat(t,"/messages"),a).then((function(t){return e(t)})).catch((function(e){return n(e.message)}))}))).then((function(e){console.log(e),n.props.history.push("/home")})).catch((function(e){console.log(e),n.setState({error:!0,errorDisc:e.message})}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"message-card"},r.a.createElement(ge.a,{component:"form",onSubmit:function(t){return e.handlePost(t)},fullWidth:!0},r.a.createElement(ce.a,{id:"outlined-multiline-static",label:"New Tweet",multiline:!0,rows:4,required:!0,variant:"outlined",value:this.state.text,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Post")),r.a.createElement("br",null),this.state.error?r.a.createElement(Ce.a,{severity:"error"},this.state.errorDisc):null)}}]),a}(n.Component),xe=Object(f.f)(Object(d.b)((function(e){return{currentUserId:e.currentUser.user.id}}),null)(Ue));var _e=Object(d.b)((function(e){return{user:e.currentUser.user}}),null)((function(e){return e.user,r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{exact:!0,path:"/"},r.a.createElement(E,null)),r.a.createElement(f.a,{path:"/signup"},r.a.createElement(Ne,{auth:"signup"})),r.a.createElement(f.a,{path:"/login"},r.a.createElement(Ne,{auth:"signin"})),r.a.createElement(f.a,{path:"/home"},r.a.createElement(V,null)),r.a.createElement(f.a,{path:"/notifications"},r.a.createElement(pe,null)),r.a.createElement(f.a,{path:"/user/:id"},r.a.createElement(fe,null)),r.a.createElement(f.a,{path:"/newTweet"},r.a.createElement(xe,null)))})),Te=a(100),Pe=Object(c.e)(u,Object(c.d)(Object(c.a)(m.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));if(localStorage.jwtToken){H(localStorage.jwtToken);try{Pe.dispatch({type:"SET_CURRENT_USER",payload:{user:Object(Te.a)(localStorage.jwtToken)}})}catch(Ie){Pe.dispatch(J({}))}}var De=function(){return r.a.createElement(d.a,{store:Pe},r.a.createElement(h.a,null,r.a.createElement(_e,null)))},Re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function We(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(De,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Re?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):We(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):We(t,e)}))}}()},30:function(e,t,a){}},[[116,1,2]]]);
//# sourceMappingURL=main.eeada5f8.chunk.js.map