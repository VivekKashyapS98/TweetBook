(this["webpackJsonptweetbook-client"]=this["webpackJsonptweetbook-client"]||[]).push([[0],{119:function(e,t,a){e.exports=a(148)},124:function(e,t,a){},148:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),o=a.n(l),c=(a(124),a(37)),i=a(21),s={isAuthenticated:!1,user:{}},u=Object(c.c)({currentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(i.a)(Object(i.a)({},e),{},{isAuthenticated:!!Object.keys(t.payload.user).length,user:t.payload.user});default:return e}}}),m=a(91);var h=a(14),d=a(19),f=a(12),p=(a(30),a(181)),g=Object(h.b)((function(e){return{auth:e.currentUser.isAuthenticated}}),null)((function(e){var t=Object(f.e)();return e.auth?(t.push("/home"),r.a.createElement("p",null,"loading...")):r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"header"},r.a.createElement("h2",{className:"logo"},"TweetBook"),r.a.createElement("div",{className:"nav"},r.a.createElement(p.a,{component:"div",color:"inherit",className:"nav-button",onClick:function(){return t.push("/signup")}},"Signup"),r.a.createElement(p.a,{component:"div",color:"inherit",className:"nav-button",onClick:function(){return t.push("/signin")}},"Login"))),r.a.createElement("div",{className:"background-img"},r.a.createElement("div",{className:"welcome"},r.a.createElement("h1",{className:"welcome-text"},"Welcome to TweetBook!"),r.a.createElement("p",{className:"welcome-desc"},r.a.createElement("b",null,"Login/Signup")," to explore more..."))))})),E=a(103),b=a(24),v=a(25),w=a(28),y=a(27),j=a(185),O=a(186),k=a(97),C=a.n(k),S=a(96),N=a.n(S),x=a(95),U=a.n(x),T=a(98),P=a.n(T),W=a(187);var D=Object(h.b)((function(e){return{user:e.currentUser.user.id}}),null)((function(e){var t=Object(f.e)();return r.a.createElement("div",{className:"navbar"},r.a.createElement(j.a,{value:e.value,className:"bottom-nav"},r.a.createElement(O.a,{component:d.b,to:"/home",label:"Home",value:"Home",icon:r.a.createElement(U.a,null),default:!0}),r.a.createElement(O.a,{component:d.b,to:"/notifications",label:"Notifications",value:"Notifications",icon:r.a.createElement(N.a,null)}),r.a.createElement(O.a,{component:d.b,to:"/user/".concat(e.user),label:"User",value:"User",icon:r.a.createElement(C.a,null)})),r.a.createElement(W.a,{component:"button",className:"add-icon",color:"primary",onClick:function(){return t.push("/newTweet")}},r.a.createElement(P.a,null)))})),I=a(23),F=a(201),R=a(188),_=a(202),A=a(65),B=a.n(A);function L(e,t,a){return new Promise((function(n,r){B.a[e](t,a).then((function(e){return n(e.data)})).catch((function(e){return r(e.response.data.error)}))}))}var z=a(99),q=a.n(z),H=function(e){var t=e.userInfo,a=e.post,l=Object(f.e)(),o=Object(i.a)({},a.user),c=Object(n.useState)(a.likes.some((function(e){return e===t.id}))?"secondary":"action"),s=Object(I.a)(c,2),u=s[0],m=s[1],h=Object(n.useState)(a.likes.length),d=Object(I.a)(h,2),p=d[0],g=d[1];return r.a.createElement("div",{className:"message-card"},r.a.createElement("p",{className:"post-text"},a.text),r.a.createElement(R.a,{component:"div",className:"msgcard-info"},r.a.createElement("div",{className:"msgcard-like"},r.a.createElement(q.a,{onClick:function(){"secondary"===u?L("delete","/api/users/".concat(t.id,"/message/").concat(a._id,"/like")).then((function(e){m("action"),g(p-1),console.log(e)})).catch((function(e){return console.log(e)})):L("post","/api/users/".concat(t.id,"/message/").concat(a._id,"/like")).then((function(e){m("secondary"),g(p+1),console.log(e)})).catch((function(e){return console.log(e)}))},fontSize:"small",color:u}),r.a.createElement("p",{style:{margin:"0 10px"}},p),r.a.createElement(F.a,{label:new Date(a.updatedAt).toDateString()})),r.a.createElement(F.a,{avatar:r.a.createElement(_.a,{alt:o.username,src:o.profileImgUrl}),onClick:function(){return l.push("/user/".concat(o._id))},label:o.username})))},J=a(189),M=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).state={feed:[],load:!1},n}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(this.state),L("get","/api/messages").then((function(t){e.setState({feed:t,load:!0}),console.log("Fetched Data: ",t)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=r.a.createElement("div",{className:"loading"},r.a.createElement(J.a,null));!0===this.state.load&&(t=Object(E.a)(this.state.feed).map((function(t,a){return r.a.createElement(H,{key:a,userInfo:e.props.user,post:t})})));return console.log(this.state.feed,this.state.load),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-page"},t),r.a.createElement(D,{value:"Home"}))}}]),a}(n.Component),Y=Object(h.b)((function(e){return{user:e.currentUser.user}}),null)(M),$=a(64),G=a(4),K=a(200),Q=a(190),V=a(192),X=a(191),Z=a(100),ee=a.n(Z),te=a(105),ae=Object(G.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose,l=Object($.a)(e,["children","classes","onClose"]);return r.a.createElement(Q.a,Object.assign({disableTypography:!0,className:a.root},l),r.a.createElement(te.a,{variant:"h6"},t),n?r.a.createElement(X.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(ee.a,null)):null)})),ne=Object(G.a)((function(e){return{root:{padding:e.spacing(2)}}}))(V.a),re={display:"flex",flexDirection:"row",borderRadius:"20px",margin:"5px",padding:"5px",minWidth:"80px"};function le(e){var t=e.user,a=Object(n.useState)(!1),l=Object(I.a)(a,2),o=l[0],c=l[1],i=Object(n.useState)(null),s=Object(I.a)(i,2),u=s[0],m=s[1],h=Object(n.useState)(null),d=Object(I.a)(h,2),f=d[0],p=d[1],g=function(e,t){c(!0),m(e),p(t)},E=function(){p(""),m(null),c(!1)},b=r.a.createElement(J.a,null);return null!==u&&(b=u.map((function(e,t){return r.a.createElement("div",{key:t,style:re},r.a.createElement(_.a,{alt:"Remy Sharp",src:e.profileImgUrl}),r.a.createElement("h4",{style:{margin:"5px"}},e.username))}))),r.a.createElement("div",null,r.a.createElement("div",{className:"profile-row"},r.a.createElement(F.a,{component:"div",style:{padding:"10px",margin:"10px"},label:"followers ".concat(t.followers.length),onClick:function(){return g(t.followers,"followers")}}),r.a.createElement(F.a,{componenet:"div",style:{padding:"10px",margin:"10px"},label:"following ".concat(t.following.length),onClick:function(){return g(t.following,"Following")}})),r.a.createElement(K.a,{onClose:E,"aria-labelledby":"customized-dialog-title",open:o},r.a.createElement(ae,{id:"customized-dialog-title",onClose:E},f),r.a.createElement(ne,null,b)))}var oe=a(197),ce=a(196),ie=a(193),se=a(101),ue=a.n(se);function me(e){var t=e.editProfile,a=Object(n.useState)(!1),l=Object(I.a)(a,2),o=l[0],c=l[1],i=Object(n.useState)(null),s=Object(I.a)(i,2),u=s[0],m=s[1],h=Object(n.useState)(null),d=Object(I.a)(h,2),f=d[0],g=d[1],E=function(){c(!1)};return r.a.createElement("div",null,r.a.createElement(p.a,{component:"button",onClick:function(){c(!0)},style:{padding:"15px",margin:"auto 0",borderRadius:"50%"},variant:"contained"},r.a.createElement(ue.a,null)),r.a.createElement(K.a,{open:o,onClose:E,"aria-labelledby":"form-dialog-title"},r.a.createElement(Q.a,{id:"form-dialog-title"},"Edit Profile:"),r.a.createElement(V.a,null,r.a.createElement(ie.a,null,"Edit the Bio:"),r.a.createElement(oe.a,{autoFocus:!0,margin:"dense",id:"name",label:"Describe yourself",type:"text",onChange:function(e){return m(e.target.value)},fullWidth:!0}),r.a.createElement(ie.a,null,"Profile Picture:"),r.a.createElement(oe.a,{autoFocus:!0,margin:"dense",id:"name",label:"Paste a link of nice picture",type:"text",onChange:function(e){return g(e.target.value)},fullWidth:!0})),r.a.createElement(ce.a,null,r.a.createElement(p.a,{onClick:E,color:"primary"},"Cancel"),r.a.createElement(p.a,{onClick:function(){t({bio:u,profilePic:f}),c(!1)},color:"primary"},"Update"))))}var he=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).state={user:null,load:!1,navbar:null,follow:null},n}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id,a=this.props.user;L("get","/api/users/".concat(t)).then((function(n){console.log(n),t===a.id?e.setState({user:n,load:!0,navbar:"User"}):n.followers.some((function(e){return e._id===a.id}))?e.setState({user:n,load:!0,follow:"following"}):e.setState({user:n,load:!0,follow:"follow"})})).catch((function(e){return console.log(e)}))}},{key:"handleFollow",value:function(){var e=this,t=this.state,a=t.follow,n=t.user;L("follow"===a?"post":"delete","/api/users/".concat(this.props.user.id,"/follow/").concat(n._id)).then((function(t){"followed"===t.tweet?e.setState({follow:"following"}):e.setState({follow:"follow"}),console.log(t.tweet)})).catch((function(e){return console.log(e)}))}},{key:"editProfile",value:function(e){var t=e.bio,a=e.profilePic,n={};null!==a&&(n=Object(i.a)(Object(i.a)({},n),{},{profileImgUrl:a})),null!==t&&(n=Object(i.a)(Object(i.a)({},n),{},{bio:t})),L("put","/api/users/".concat(this.props.user.id),n).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this,t=r.a.createElement(J.a,null);if(!0===this.state.load){var a=this.state.user,n=a._id,l=a.username,o=a.profileImgUrl,c=a.bio,s=a.followers,u=a.following,m=a.messages.map((function(t,a){return r.a.createElement(H,{key:a,userInfo:e.props.user,post:Object(i.a)(Object(i.a)({},t),{},{user:{_id:n,username:l,profileImgUrl:o}})})}));t=r.a.createElement("div",null,r.a.createElement("div",{className:"profile-row"},r.a.createElement("img",{className:"profile-img",src:o||"https://www.knack.com/images/about/default-profile.png",alt:"profile-img"}),r.a.createElement("div",{className:"profile-info"},r.a.createElement("h1",{className:"username"},l),r.a.createElement("p",{style:{color:"white",maxWidth:"500px"}},c),r.a.createElement(le,{user:{followers:s,following:u}})),this.state.navbar?r.a.createElement(me,{editProfile:function(t){return e.editProfile(t)}}):r.a.createElement(p.a,{component:"button",style:{margin:"auto 0"},variant:"contained",onClick:function(){return e.handleFollow()}},this.state.follow)),m)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"home-page"},t),r.a.createElement(D,{value:this.state.navbar}))}}]),a}(n.Component),de=Object(f.f)(Object(h.b)((function(e){return{user:e.currentUser.user}}),null)(he)),fe=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(){return Object(b.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(D,{value:"Notifications"}))}}]),a}(n.Component),pe=a(50),ge=function(e){!function(e){e?B.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete B.a.defaults.headers.common.Authorization}(e)},Ee=function(e,t){return function(a){return new Promise((function(n,r){L("post","/api/auth/".concat(e),t).then((function(e){var t=e.token,r=Object($.a)(e,["token"]);localStorage.setItem("jwtToken",t),ge(localStorage.jwtToken),a({type:"SET_CURRENT_USER",payload:{user:r}}),n(r)})).catch((function(e){return r(e)}))}))}},be=a(203),ve=a(204),we=a(194),ye=a(195);function je(e){var t=e.handleChange,a=e.input;return r.a.createElement(be.a,{fullWidth:!0},r.a.createElement(ve.a,{htmlFor:"my-input"},"User Name:"),r.a.createElement(we.a,{required:!0,type:"text",id:"my-input","aria-describedby":"my-helper-text",name:"username",value:a,onChange:function(e){return t(e)}}),r.a.createElement(ye.a,{id:"my-helper-text"},"Enter the user name."))}function Oe(e){var t=e.handleChange,a=e.input;return r.a.createElement(be.a,{fullWidth:!0},r.a.createElement(ve.a,{htmlFor:"my-input"},"Email address"),r.a.createElement(we.a,{required:!0,type:"text",id:"my-input","aria-describedby":"my-helper-text",name:"email",value:a,onChange:function(e){return t(e)}}),r.a.createElement(ye.a,{id:"my-helper-text"},"We'll never share your email."))}function ke(e){var t=e.handleChange;return r.a.createElement(be.a,{fullWidth:!0},r.a.createElement(ve.a,{htmlFor:"my-input"},"Password"),r.a.createElement(we.a,{required:!0,type:"password",id:"my-input","aria-describedby":"my-helper-text",name:"password",onChange:function(e){return t(e)}}),r.a.createElement(ye.a,{id:"my-helper-text"},"Your passwords are always safe."))}function Ce(e){var t=e.handleChange,a=e.input;return r.a.createElement(be.a,{fullWidth:!0},r.a.createElement(ve.a,{htmlFor:"my-input"},"Profile picture link:"),r.a.createElement(we.a,{id:"my-input","aria-describedby":"my-helper-text",value:a,name:"profileImgUrl",onChange:function(e){return t(e)}}),r.a.createElement(ye.a,{id:"my-helper-text"},"Enter the URL of the profile picture."))}var Se=a(198),Ne=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).state={error:!1,errorDisc:"",auth:"",username:"",email:"",password:"",profileImgUrl:""},n}return Object(v.a)(a,[{key:"handleChange",value:function(e){var t;this.setState((t={},Object(pe.a)(t,e.target.name,e.target.value),Object(pe.a)(t,"auth",this.props.auth),t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.auth,r=a.username,l=a.email,o=a.password,c=a.profileImgUrl;"signup"===n?this.props.setCurrentUser(n,{username:r,email:l,password:o,profileImgUrl:c}).then((function(){t.props.history.push("/home")})).catch((function(e){return t.setState({error:!0,errorDisc:e.message})})):this.props.setCurrentUser(n,{email:l,password:o}).then((function(){t.props.history.push("/home")})).catch((function(e){return t.setState({error:!0,errorDisc:e.message})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.email,l=t.profileImgUrl,o="signup"===this.props.auth?r.a.createElement("div",{className:"form"},r.a.createElement("h2",{className:"auth-text"},"Join TweetBook today!"),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(je,{input:a,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(Oe,{input:n,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(Ce,{input:l,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(ke,{handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Signup"),r.a.createElement("br",null),this.state.error?r.a.createElement(Se.a,{severity:"error"},this.state.errorDisc):null)):r.a.createElement("div",{className:"form"},r.a.createElement("h2",{className:"auth-text"},"Login to TweetBook Now!"),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(Oe,{input:n,handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(ke,{handleChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Login"),r.a.createElement("br",null),this.state.error?r.a.createElement(Se.a,{severity:"error"},this.state.errorDisc):null));return r.a.createElement(r.a.Fragment,null,o)}}]),a}(n.Component);var xe=Object(f.f)(Object(h.b)((function(e){return{currentUser:e.currentUser}}),{setCurrentUser:Ee})(Ne)),Ue=function(e){Object(w.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(b.a)(this,a),(n=t.call(this,e)).state={text:"",error:!1,errorDisc:""},n}return Object(v.a)(a,[{key:"handleChange",value:function(e){this.setState({text:e.target.value})}},{key:"handlePost",value:function(e){var t,a,n=this;e.preventDefault(),(t=this.props.currentUserId,a={text:this.state.text},new Promise((function(e,n){L("post","/api/users/".concat(t,"/messages"),a).then((function(t){return e(t)})).catch((function(e){return n(e.message)}))}))).then((function(e){console.log(e),n.props.history.push("/home")})).catch((function(e){console.log(e),n.setState({error:!0,errorDisc:e.message})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(be.a,{component:"form",onSubmit:function(t){return e.handlePost(t)},fullWidth:!0},r.a.createElement(oe.a,{id:"outlined-multiline-static",label:"New Tweet",multiline:!0,rows:4,required:!0,variant:"outlined",value:this.state.text,onChange:function(t){return e.handleChange(t)}}),r.a.createElement("br",null),r.a.createElement(p.a,{type:"submit",variant:"contained",color:"primary"},"Post")),r.a.createElement("br",null),this.state.error?r.a.createElement(Se.a,{severity:"error"},this.state.errorDisc):null)}}]),a}(n.Component),Te=Object(f.f)(Object(h.b)((function(e){return{currentUserId:e.currentUser.user.id}}),null)(Ue));var Pe=Object(h.b)((function(e){return{user:e.currentUser.user}}),null)((function(e){return e.user,r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{exact:!0,path:"/"},r.a.createElement(g,null)),r.a.createElement(f.a,{path:"/signup"},r.a.createElement(xe,{auth:"signup"})),r.a.createElement(f.a,{path:"/signin"},r.a.createElement(xe,{auth:"signin"})),r.a.createElement(f.a,{path:"/home"},r.a.createElement(Y,null)),r.a.createElement(f.a,{path:"/notifications"},r.a.createElement(fe,null)),r.a.createElement(f.a,{path:"/user/:id"},r.a.createElement(de,null)),r.a.createElement(f.a,{path:"/newTweet"},r.a.createElement(Te,null)))})),We=a(102),De=Object(c.e)(u,Object(c.d)(Object(c.a)(m.a)));if(localStorage.jwtToken){ge(localStorage.jwtToken);try{De.dispatch({type:"SET_CURRENT_USER",payload:{user:Object(We.a)(localStorage.jwtToken)}})}catch(_e){De.dispatch(Ee({}))}}var Ie=function(){return r.a.createElement(h.a,{store:De},r.a.createElement(d.a,null,r.a.createElement(Pe,null)))},Fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Re(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ie,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Fe?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Re(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Re(t,e)}))}}()},30:function(e,t,a){}},[[119,1,2]]]);
//# sourceMappingURL=main.fad0ac79.chunk.js.map